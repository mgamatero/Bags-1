<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Collections</title>

  <!-- CSS  -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="../assets/css/style.css" type="text/css" rel="stylesheet" media="screen,projection" />
</head>

<body>
  <!-- nav bar starts here -->
  <div class="navbar-fixed">
    <nav class="white" role="navigation">
      <div class="nav-wrapper container">
        <ul class="left hide-on-med-and-down">
          <li>
            <a id="logo-container" href="/" class="left">Home</a>
          </li>
          <li>
            <a href="/collections">Collections</a>
          </li>
          <li>
            <a href="/popular">Popular</a>
          </li>
          <li>
            <a href="/sell">Sell</a>
          </li>
          <li>
            <a href="/users">Account</a>
          </li>
        </ul>
        <ul class="right hide-on-med-and-down">
          <li>
            <a href="sass.html">
              <i class="material-icons">search</i>
            </a>
          </li>
          <li>
            <a href="sass.html">
              <i class="material-icons">shopping_cart</i>
            </a>
          </li>
          <li>
            <a href="/users">
              <i class="material-icons">account_circle</i>
            </a>
          </li>
          <li>
            <a class="waves-effect waves-light btn">Login</a>
          </li>
        </ul>

      </div>
    </nav>
  </div>
  <!-- nav bar ends here -->
  <div class="container">

    <!-- Entire Body Starts -->
    <div class="row">

      <!-- Filter Column Starts -->
      <div class="col s12 m4 l3">
        <!-- Note that "m4 l3" was added -->
        <ul class="collection with-header">
          <li class="collection-header">
            <h6>Filter by Designer</h6>
          </li>
          <div class="collection">
            <a href="#!" class="designer_filter collection-item active" value="All">All</a>
            <a href="#" class="designer_filter collection-item" value="Chanel">Chanel</a>
            <a href="#!" class="designer_filter collection-item" value="Hermes">Hermes</a>
            <a href="#!" class="designer_filter collection-item" value="Louis Vuitton">Louis Vuitton</a>
            <a href="#!" class="designer_filter collection-item" value="Prada">Prada</a>
            <a href="#!" class="designer_filter collection-item" value="Other">Other</a>
          </div>
        </ul>

        <ul class="collection with-header">
          <li class="collection-header">
            <h6>Filter by Material</h6>
          </li>
          <div class="collection">
            <a href="#!" class="material_filter collection-item active" value="All">All</a>
            <a href="#" class="material_filter collection-item" value="Leather">Leather</a>
            <a href="#!" class="material_filter collection-item" value="Canvas">Canvas</a>
            <a href="#!" class="material_filter collection-item" value="Nylon">Nylon</a>
            <a href="#!" class="material_filter collection-item" value="Other">Other</a>
          </div>
        </ul>

        <ul class="collection with-header">
          <li class="collection-header">
            <h6>Filter by Color</h6>
          </li>
          <div class="collection">
            <a href="#!" class="color_filter collection-item active" value="All">All</a>
            <a href="#" class="color_filter collection-item" value="Black">Black</a>
            <a href="#!" class="color_filter collection-item" value="Blue">Blue</a>
            <a href="#!" class="color_filter collection-item" value="Brown">Brown</a>
            <a href="#!" class="color_filter collection-item" value="Red">Red</a>
            <a href="#!" class="color_filter collection-item" value="Other">Other</a>
          </div>
        </ul>
      </div>
      <!-- Filter Column Ends -->

      <!-- Product Gallery Section Starts -->
      <div class="col s12 m8 l9" id="collectionColumn" >
        <!-- Note that "m8 l9" was added -->

        <!-- Second Column Starts -->
        <div class="row">
          <div class="col s12">
            <!--Dynamic bags results appear here  -->
            <div class="collection-results"></div>
          </div>
        </div>
        <!-- Second Column Ends -->
      </div>
      <!-- Product Gallery Section Ends -->
    </div>
    <!-- Entire Body Ends -->


    <!-- footer starts here -->
    <footer class="page-footer teal">
      <div class="container">
        <div class="row">
          <div class="col l6 s12">
            <h5 class="white-text">Company Bio</h5>
            <p class="grey-text text-lighten-4">The most stylish global marketplace to buy and sell pre-owned luxury handbags and purses. Every day, carefully
                selected new products are uploaded from brands such as Chanel, Louis Vuitton, Burberry, Celine... We offer the
                most coveted and hard-to-find items. All items are curated and quality checked by our team of experts. You can
                sell to our community of over 3 million fashion lovers around the world. Our curators accept thousands of luxury
                and designer brands including Alexander Wang, Michael Kors, Chanel, Sandro... By selling your items,
                you are able to refresh your closet and boost your shopping budget for new pieces! It's never been easier to
                make money and refresh your wardrobe. Buy, sell, share!</p>

          </div>
          <div class="col l3 s12">
            <h5 class="white-text"></h5>
          </div>
          <div class="col l3 s12">
            <h5 class="white-text">Contact Us</h5>
            <ul>
              <li>
                <a class="white-text" href="#!">Address</a>
              </li>
              <li>
                <a class="white-text" href="#!">Phone</a>
              </li>
              <li>
                <a class="white-text" href="#!">Twitter</a>
              </li>
              <li>
                <a class="white-text" href="#!">Facebook</a>
              </li>
              <li>
                <a class="white-text" href="#!">Instagram</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="footer-copyright">
        <div class="container">
          Copyright 2018
          <a class="brown-text text-lighten-3">Locally Sourced "Cool Grandpa T-Shirts"</a>
        </div>
      </div>
    </footer>
    <!-- footer ends here -->



    <!--  Scripts-->
    <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>

    <script> 
      //GLOBALS used to capture values from filters
      var designer = "All"
      var material = "All"
      var color = "All"
                 
      //Show all bags on first
      renderBagsToScreen("/api/bags")

      
      //On click events for designer filter      
      $(".designer_filter").on('click', function () {
        // $(".designer_filter").removeClass("active") - use later for filter fix
        
        // manipulates the highlighted filter selection
        $(".collection-item").removeClass("active")
        $(this).addClass("active")

        //scrolls to top  
        $("html, body").animate({ scrollTop: 0 }, "slow");
        var path = ''
        designer = $(this).attr("value")
        
        //determines which route, based on filter selections
        if (designer==="All"){
          path = 'api/bags'
        }
        else if(designer==="Other"){
          path = 'api/bags/other/'+ designer
        }
        else {
          path = '/api/bags/' + designer
        }
        renderBagsToScreen(path)
      })
      

      //On click events for material filter      
      $(".material_filter").on('click', function () {
        // $(".material_filter").removeClass("active") - use later for filter fix
        $(".collection-item").removeClass("active")
        $(this).addClass("active")
        material = $(this).attr("value")
        $("html, body").animate({ scrollTop: 0 }, "slow");
        var path = ''
        if (material==="All"){
          path = 'api/bags'
        }
        else if(material==="Other"){
          path = 'api/bags/other/'+ material
        }
        else {
          var path = '/api/bags/' + material
        }
        renderBagsToScreen(path)
      })
      
      //On click events for color filter      
      $(".color_filter").on('click', function () {
        // $(".color_filter").removeClass("active") - use later for filter fix
        $(".collection-item").removeClass("active")
        $(this).addClass("active")
        color = $(this).attr("value")
        $("html, body").animate({ scrollTop: 0 }, "slow");
        var path = ''
        if (color==="All"){
          path = 'api/bags'
        }
        else if(color==="Other"){
          path = 'api/bags/other/'+ color
        }
        else {
          var path = '/api/bags/' + color
        }
        renderBagsToScreen(path)
      })
    


      //render bags to screen, based on routePath.  Dependent on the click action from
      //designer, material, and color filters
      function renderBagsToScreen(routePath) {
        $(".collection-results").empty()
        $.get(routePath).then(function (r) {
          if (r.length === 0) {
            $(".collection-results").append("No bags available")
          }
          else {
            for (var i = 0; i < r.length; i++) {

              $(".collection-results").append(
                '<div class="col s4">\
              <a href = /buy><div class="card card_bag" data-index="'+i+ '" index="'+ i + '">\
                <div class="card-image">\
                  <img src="'+ r[i].image + '" class="bag_image hoverZoomLink">\
                </div>\
                <div class="card-content card_bag-content">'+ r[i].model + " by " + r[i].name + '<p>$' + r[i].price + '</p>\
                <p>'+ r[i].material + ", " + r[i].color + '</p>\
                </div>\
              </div></a>'
              )
            }
          }

          //Clicking on card gets stores dbs index in localStorage
          $('.card_bag').on('click', function () {
           var x = r[$(this).attr("index")].name + ", " + r[$(this).attr("index")].material
         // alert(x)
           // alert("Shaz, passing Index: "+r[$(this).attr("index")].id+" in localStorage.  Just use localStorage.getItem('BagIndexToBuy')" )
            localStorage.setItem("BagIndexToBuy",r[$(this).attr("index")].id)
            console.log("Testing getItem: "+localStorage.getItem("BagIndexToBuy"))
          })
        })
      }

      
    </script>



</body>

</html>